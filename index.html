<!doctype html>
<html lang="zh">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Christmas Tree (All Blinking Stars)</title>
<style>
  body{
    margin:0; min-height:100vh;
    display:flex; align-items:center; justify-content:center;
    background:#0b1020;
    font-family: Consolas, ui-monospace, monospace;
  }
  .console{
    background:#000;
    padding:18px 22px;
    border-radius:14px;
    box-shadow: 0 10px 30px rgba(0,0,0,.45);
    width:min(760px, 94vw);
  }
  pre{
    margin:0;
    font-size:16px;
    line-height:1.15;
    white-space:pre;
    user-select:none;
  }
  .cell{
    display:inline-block;
    width:1ch;
    text-align:center;
  }

  .star{ color:#ffd54a; }   /* 默认黄 */
  .r{ color:#ff4d4d; }
  .b{ color:#4da3ff; }
  .y{ color:#ffd54a; }
  .w{ color:#e5e7eb; }
  .trunk{ color:#c08457; }
  .msg{ color:#e5e7eb; }
</style>
</head>
<body>
<div class="console"><pre id="out"></pre></div>

<script>
const out = document.getElementById("out");

/* ===== 参数 ===== */
const H = 14;              // 树高
const rowSpeed = 70;       // 生长速度
const blinkSpeed = 220;    // 闪烁速度
const SEED = 20251225;     // 固定随机（位置稳定）

const W = H * 2 + 15;
const C = Math.floor(W / 2);
const rows = H + 9;

const blank = `<span class="cell">&nbsp;</span>`;
let grid = Array.from({length: rows}, () => Array.from({length: W}, () => blank));

/* 固定随机 */
function mulberry32(a){
  return function(){
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}
const rnd = mulberry32(SEED);

/* 可闪颜色 */
const colors = ["r","b","y","w"];
const randColor = () => colors[Math.floor(Math.random() * colors.length)];

/* 所有星星都放这里 */
const stars = [];

function put(x,y,html){
  if (y<0||y>=rows||x<0||x>=W) return;
  grid[y][x] = html;
}
function render(){
  out.innerHTML = grid.map(r=>r.join("")).join("\n");
}

/* 树顶星 */
put(C, 0, `<span class="cell star">★</span>`);

/* 生成整棵树：每一个位置都是星星 */
const layers = [];
for (let i=0;i<H;i++){
  const y = i+1;
  const left = C-i;
  const right = C+i;
  const row = [];
  for (let x=left;x<=right;x++){
    row.push({x,y,cls: randColor()});
  }
  layers.push(row);
}

/* 逐行长出来 */
let idx = 0;
const grow = setInterval(()=>{
  if (idx >= layers.length){
    clearInterval(grow);

    /* 树干：2×3 */
    const ty = H+1;
    const trunk = [
      [C-1,ty],[C,ty],
      [C-1,ty+1],[C,ty+1],
      [C-1,ty+2],[C,ty+2],
    ];
    trunk.forEach(([x,y])=>{
      put(x,y,`<span class="cell trunk">█</span>`);
    });

    /* 祝福语 */
    const msg = "Merry  Christmas!";
    const sx = C - Math.floor(msg.length/2);
    const yMsg = ty+4;
    for (let i=0;i<msg.length;i++){
      const ch = msg[i]===" "?"&nbsp;":msg[i];
      put(sx+i,yMsg,`<span class="cell msg">${ch}</span>`);
    }

    render();

    /* ⭐ 全树星星一起闪 ⭐ */
    setInterval(()=>{
      for (const s of stars){
        s.cls = randColor();
        put(s.x,s.y,`<span class="cell ${s.cls}">★</span>`);
      }
      render();
    }, blinkSpeed);

    return;
  }

  for (const p of layers[idx]){
    stars.push(p);
    put(p.x,p.y,`<span class="cell ${p.cls}">★</span>`);
  }
  idx++;
  render();
}, rowSpeed);

render();
</script>
</body>
</html>


render();
</script>
</body>
</html>
